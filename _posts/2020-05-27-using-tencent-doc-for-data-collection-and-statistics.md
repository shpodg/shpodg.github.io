---
title: 使用腾讯文档进行数据收集和统计
tags: 腾讯文档
key: using-tencent-doc-for-data-collection-and-statistics
---

# 数据收集问题
经常会遇到各种数据收集的需求，比如临时组织了一个活动要进行报名统计、个人资料统计等。很多人会选择在群里面进行接龙，大家在群里面回复的七零八落。又或者让所有人都各自填一个表格，通过QQ微信文件发来发去。这些方式整理起来不仅非常麻烦，而且如果收集的信息中含有敏感信息就会引起信息泄露。这个时候我们可以借助腾讯文档的`收集表`功能来进行统计。
# 收集表介绍
收集表可以让你设计一个表单页面，可以在这个页面上设置单行问答、多行问答、单选题、多选题、下拉列表、日期、时间问题，并设置一些字段校验来防止填错。收集表可以分享到QQ或者微信上面，用户可以通过QQ或者微信进行登录填报。

<img class="image image--lg" src="/assets/images/202005/20200527175227.jpg"/>

# 收集表关联表格
收集表相当于一个数据库，保存着所有收集到的数据。你可以通过关联表格来把收集表中的数据导入到一个表格中。收集表中有新信息的时候，表格会跟着更新。你也可以在表格中去更新收集表的数据，但是这个修改并不会反应到收集表中，如果不小心取消了收集表和表格的关联，还可以重新在收集表里面关联一个新的表格文件，这个时候之前直接在表格里面操作更新的数据会丢失。收集表没有提供更新提交后的数据的功能，这个时候可以再填一份正确的数据，在收集表的管理端把有问题的那条记录删除来起到更新提交的作用。

# 使用表格进行统计
数据导入到表格中就很方便处理了，腾讯文档的表格支持大部分的Excel计算函数。下面我们做一个按照月份来统计销量的示例。
加入我们有一个纯净水的销售记录收集表同时关联了表格。
## 添加sheet
<img class="image image--xl" src="/assets/images/202005/20200527185951.jpg"/>
我们添加一个sheet命名为2020销售报表。
在我们新添加的sheet页中添加一个表格，并设置月份列。
## 设计统计表格
<img class="image image--xl"  src="/assets/images/202005/20200527192151.jpg"/>

腾讯文档的函数支持没有Excel那么强大，经过一番折腾，终于试验出表格支持如下统计方式。整体思路是通过判断日期在某个月的第一个到最后一天之间的数据来达到月份的统计，其它诸如季度统计、年份统计等都可以通过这种方式来实现。
```BASIC
=SUMIFS(纯净水销售记录!F:F,纯净水销售记录!C:C,">="&DATE(2020,A2,1),纯净水销售记录!C:C,"<="&EOMONTH("2020/1/1",A2-1))
```
函数的作用如下表格所示

函数|签名|描述
--|--|--
SUMIFS|SUMIFS(求和范围,条件范围1,条件1,[条件范围2, ...], [条件2, ...])|根据条件范围对指定范围进行求和，注意这里的条件是个>,<,=等开头的字符串
DATE|DATE(年,月,日)|采用三个单独的值并将它们合并为一个日期。
EOMONTH|EOMONTH(起始日期,月数)|原始文档：返回日期（以序列数表示）中的月份。月份是介于1（一月）到12（十二月）之间的整数。**注意这里文档说的有点问题，这个函数返回的是从起始日期到累计某月的最后一天的日期值。**

## 插入图表
最后我们根据统计表格的数据插入柱状图来让数据可视化显示。效果如下。

<img  src="/assets/images/202005/20200527190335.jpg"/>

表格配置如下
- 数据范围：A1:C13
- 勾选**将首行用作图例名称**
- 勾选**将首列用作坐标类别名称**

# 总结
通过在线表格进行数据统计，能确保数据在云上面而防止因为其他原因造成的数据丢失。收集表也很容易分享给QQ微信等移动端、PC端从而提高了数据填写的效率和准确率。收集者还能根据分组进行分享来跟踪收集的进度。在没有现成工具的场景下，通过对在线表格的应用和协作，很大程度上提升了我们的工作效率，也保障了安全性。